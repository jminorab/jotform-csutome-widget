<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="//js.jotform.com/JotFormCustomWidget.min.js"></script>
    <style>
        body {
            font-family: sans-serif;
            padding: 1rem;
            background-color: #f8f8f8;
            color: #333;
        }
        .form-group {
            display: flex;
            flex-direction: column;
            margin-bottom: 1rem;
        }
        label {
            margin-bottom: 0.5rem;
            font-weight: bold;
            color: #555;
        }
        select, input[type="text"] {
            padding: 0.75rem;
            border: 1px solid #ccc;
            border-radius: 8px;
            background-color: #fff;
            font-size: 1rem;
            cursor: pointer;
        }
        select:focus, input[type="text"]:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25);
        }
        input[type="text"] {
            margin-top: 0.5rem;
            width: 100%;
            box-sizing: border-box;
            cursor: text;
        }
        /* Style for initially hidden text inputs */
        .other-input-hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="form-group">
        <label for="state">State:</label>
        <select id="state" onchange="updateDistricts(); toggleOtherInput('state'); sendWidgetData();">
            <option value="">Please choose</option>
        </select>
        <input type="text" id="otherStateInput" class="other-input-hidden" placeholder="Enter State" oninput="sendWidgetData();">
    </div>
    <div class="form-group">
        <label for="district">District:</label>
        <select id="district" onchange="updateSites(); toggleOtherInput('district'); sendWidgetData();">
             <option value="">Choose State First</option>
        </select>
        <input type="text" id="otherDistrictInput" class="other-input-hidden" placeholder="Enter District" oninput="sendWidgetData();">
    </div>
    <div class="form-group">
        <label for="site">Site:</label>
        <select id="site" onchange="toggleOtherInput('site'); sendWidgetData();">
            <option value="">Choose District First</option>
        </select>
        <input type="text" id="otherSiteInput" class="other-input-hidden" placeholder="Enter Site" oninput="sendWidgetData();">
    </div>
   
 <script>
        const data = [
            {"state": "CA", "district": "Alhambra", "site name": "Fremont Elementary"},
            {"state": "CA", "district": "Alhambra", "site name": "Granada Elementary"},
            {"state": "CA", "district": "Alhambra", "site name": "Marguerita Elementary"},
            {"state": "CA", "district": "Alhambra", "site name": "Repetto Elementary"},
            {"state": "AZ", "district": "Amphitheater", "site name": "Copper Creek Elementary School"},
            {"state": "AZ", "district": "Amphitheater", "site name": "F. O. Holaway Elementary School"},
            {"state": "AZ", "district": "Amphitheater", "site name": "Innovation Academy"},
            {"state": "AZ", "district": "Amphitheater", "site name": "Lulu Walker Elementary School"},
            {"state": "AZ", "district": "Amphitheater", "site name": "Marion Donaldson Elementary School"},
            {"state": "AZ", "district": "Amphitheater", "site name": "Mesa Verde Elementary School"},
            {"state": "AZ", "district": "Amphitheater", "site name": "Painted Sky Elementary School"},
            {"state": "AZ", "district": "Amphitheater", "site name": "Richard B. Wilson K-8 School"},
            {"state": "AZ", "district": "Amphitheater", "site name": "Rio Vista Elementary School"},
            {"state": "AZ", "district": "Amphitheater", "site name": "Winifred Harelson Elementary School"},
            {"state": "TX", "district": "Aubrey", "site name": "HL Brockett Elementary School"},
            {"state": "TX", "district": "Aubrey", "site name": "Jackie Fuller Elementary School"},
            {"state": "TX", "district": "Aubrey", "site name": "Monaco Elementary School"},
            {"state": "TX", "district": "Aubrey", "site name": "Pete and Myra West Elementary School"},
            {"state": "NJ", "district": "Berlin Borough", "site name": "Berlin Community School"},
            {"state": "TX", "district": "Blue Ridge", "site name": "Blue Ridge Elementary School"},
            {"state": "NJ", "district": "Bogota", "site name": "E Roy Bixby Elementary School"},
            {"state": "NJ", "district": "Bogota", "site name": "Lillian M. Steen Elementary School"},
            {"state": "TX", "district": "Bryan", "site name": "Bonham Elementary"},
            {"state": "TX", "district": "Bryan", "site name": "Bowen Elementary School"},
            {"state": "TX", "district": "Bryan", "site name": "Branch Elementary School"},
            {"state": "TX", "district": "Bryan", "site name": "Crockett Elementary School"},
            {"state": "TX", "district": "Bryan", "site name": "Fannin Elementary School"},
            {"state": "TX", "district": "Bryan", "site name": "Henderson Elementary School"},
            {"state": "TX", "district": "Bryan", "site name": "Houston Elementary School"},
            {"state": "TX", "district": "Bryan", "site name": "Jane Long Intermediate School"},
            {"state": "TX", "district": "Bryan", "site name": "Johnson Elementary"},
            {"state": "TX", "district": "Bryan", "site name": "Kemp Elementary School"},
            {"state": "TX", "district": "Bryan", "site name": "Mitchell Elementary School"},
            {"state": "TX", "district": "Bryan", "site name": "Navarro Elementary School"},
            {"state": "TX", "district": "Bryan", "site name": "Ross Elementary School"},
            {"state": "TX", "district": "Bryan", "site name": "Sadberry Intermediate"},
            {"state": "TX", "district": "Bryan", "site name": "Sam Rayburn Intermediate School"},
            {"state": "CA", "district": "Buena Park", "site name": "Carl E. Gilbert Elementary School"},
            {"state": "CA", "district": "Buena Park", "site name": "Mabel L. Pendleton Elementary School"},
            {"state": "TX", "district": "Caddo Mills", "site name": "Griffis Elementary"},
            {"state": "TX", "district": "Caddo Mills", "site name": "Kirkpatrick Elementary"},
            {"state": "TX", "district": "Caddo Mills", "site name": "Lee Elementary"},
            {"state": "NJ", "district": "Cedar Grove", "site name": "Cedar Grove Memorial Middle School"},
            {"state": "NJ", "district": "Cedar Grove", "site name": "North End School"},
            {"state": "NJ", "district": "Cedar Grove", "site name": "South End School"},
            {"state": "TX", "district": "Celina", "site name": "Bothwell Elementary"},
            {"state": "TX", "district": "Celina", "site name": "Celina Primary School"},
            {"state": "TX", "district": "Celina", "site name": "Donny O'Dell Elementary School"},
            {"state": "TX", "district": "Celina", "site name": "Lykins Elementary School"},
            {"state": "TX", "district": "Celina", "site name": "Margie Moore Vasquez Elementary School"},
            {"state": "TX", "district": "Celina", "site name": "Martin Elementary School"},
            {"state": "MD", "district": "Charles County", "site name": "Arthur Middleton Elementary"},
            {"state": "MD", "district": "Charles County", "site name": "Berry Elementary School"},
            {"state": "MD", "district": "Charles County", "site name": "Billingsley Elementary School"},
            {"state": "MD", "district": "Charles County", "site name": "C. Paul Barnhart Elementary School"},
            {"state": "MD", "district": "Charles County", "site name": "Daniel of Saint Thomas Jenifer Elementary School"},
            {"state": "MD", "district": "Charles County", "site name": "Dr. Gustavus Brown Elementary School"},
            {"state": "MD", "district": "Charles County", "site name": "Dr. James Craik Elementary School"},
            {"state": "MD", "district": "Charles County", "site name": "Dr. Samuel A. Mudd Elementary School"},
            {"state": "MD", "district": "Charles County", "site name": "Dr. Thomas L. Higdon Elementary School"},
            {"state": "MD", "district": "Charles County", "site name": "Eva Turner Elementary"},
            {"state": "MD", "district": "Charles County", "site name": "Gale-Bailey Elementary School"},
            {"state": "MD", "district": "Charles County", "site name": "Indian Head Elementary School"},
            {"state": "MD", "district": "Charles County", "site name": "J C Parks Elementary School"},
            {"state": "MD", "district": "Charles County", "site name": "J.P. Ryon Elementary School"},
            {"state": "MD", "district": "Charles County", "site name": "Malcolm Elementary School"},
            {"state": "MD", "district": "Charles County", "site name": "Margaret Jameson Thornton"},
            {"state": "MD", "district": "Charles County", "site name": "Mary B Neal Elementary School"},
            {"state": "MD", "district": "Charles County", "site name": "Mary H. Matula Elementary School"},
            {"state": "MD", "district": "Charles County", "site name": "Mt Hope Nanjemoy Elementary"},
            {"state": "MD", "district": "Charles County", "site name": "Port Tobacco"},
            {"state": "MD", "district": "Charles County", "site name": "T.C. Martin Elementary School"},
            {"state": "MD", "district": "Charles County", "site name": "The Early Learning Center"},
            {"state": "MD", "district": "Charles County", "site name": "The Early Learning Center of Waldorf"},
            {"state": "MD", "district": "Charles County", "site name": "Walter J Mitchell Elementary"},
            {"state": "MD", "district": "Charles County", "site name": "William A. Diggs Elementary School"},
            {"state": "MD", "district": "Charles County", "site name": "William B. Wade Elementary School"},
            {"state": "CO", "district": "Arapahoe : STARS", "site name": "AXIS International Academy"},
            {"state": "CO", "district": "Arapahoe : STARS", "site name": "AXL Academy"},
            {"state": "CO", "district": "Adams : STARS", "site name": "Crown Pointe Academy"},
            {"state": "CO", "district": "Jefferson : STARS", "site name": "Lawrence Elementary"},
            {"state": "CO", "district": "Denver : STARS", "site name": "Monarch Montessori"},
            {"state": "CO", "district": "El Paso : STARS", "site name": "Roosevelt Charter Academy"},
            {"state": "CO", "district": "Jefferson : STARS", "site name": "Swanson Elementary"},
            {"state": "CO", "district": "El Paso : STARS", "site name": "Vanguard School - Lower Elementary"},
            {"state": "CO", "district": "El Paso : STARS", "site name": "Vanguard School - Upper Elementary"},
            {"state": "CO", "district": "Weld : STARS", "site name": "Vista Ridge Academy"},
            {"state": "TX", "district": "Cityscape", "site name": "Buckner Preparatory"},
            {"state": "TX", "district": "Cityscape", "site name": "Early Childhood Center"},
            {"state": "TX", "district": "Cityscape", "site name": "East Grand Preparatory"},
            {"state": "NJ", "district": "Cranbury", "site name": "The Cranbury School"},
            {"state": "TX", "district": "Crandall", "site name": "Barbara Walker Elementary School"},
            {"state": "TX", "district": "Crandall", "site name": "Hollis T. Dietz Elementary School"},
            {"state": "TX", "district": "Crandall", "site name": "Noble-Reed Elementary School"},
            {"state": "TX", "district": "Crandall", "site name": "Nola Kathryn Wilson Elementary School"},
            {"state": "TX", "district": "Crandall", "site name": "Smith Elementary School"},
            {"state": "RI", "district": "Cumberland", "site name": "Ashton Elementary School"},
            {"state": "RI", "district": "Cumberland", "site name": "Bernard F. Norton School"},
            {"state": "RI", "district": "Cumberland", "site name": "Community School"},
            {"state": "RI", "district": "Cumberland", "site name": "Garvin Memorial School"},
            {"state": "RI", "district": "Cumberland", "site name": "J.J. McLaughlin Cumberland Hill Elementary School"},
            {"state": "OR", "district": "David Douglas", "site name": "Cherry Park Elementary"},
            {"state": "OR", "district": "David Douglas", "site name": "Earl Boyles Elementary"},
            {"state": "OR", "district": "David Douglas", "site name": "Gilbert Height Elementary"},
            {"state": "OR", "district": "David Douglas", "site name": "Gilbert Park Elementary"},
            {"state": "OR", "district": "David Douglas", "site name": "Lincoln Park Elementary"},
            {"state": "OR", "district": "David Douglas", "site name": "Menlo Park Elementary"},
            {"state": "OR", "district": "David Douglas", "site name": "Mill Park Elementary"},
            {"state": "OR", "district": "David Douglas", "site name": "Ventura Park Elementary"},
            {"state": "OR", "district": "David Douglas", "site name": "West Powellhurst Elementary"},
            {"state": "NJ", "district": "Demarest", "site name": "County Road School"},
            {"state": "NJ", "district": "Demarest", "site name": "Luther Lee Emerson School"},
            {"state": "MA", "district": "Dennis-Yarmouth", "site name": "Dennis Intermediate School"},
            {"state": "MA", "district": "Dennis-Yarmouth", "site name": "Ezra H Baker Innovation School"},
            {"state": "MA", "district": "Dennis-Yarmouth", "site name": "Marguerite E Small Elementary"},
            {"state": "MA", "district": "Dennis-Yarmouth", "site name": "Station Avenue Elementary"},
            {"state": "MA", "district": "Everett", "site name": "George Keverian School"},
            {"state": "MA", "district": "Everett", "site name": "Lafayette School"},
            {"state": "MA", "district": "Everett", "site name": "Madeline English School"},
            {"state": "MA", "district": "Everett", "site name": "Parlin School"},
            {"state": "MA", "district": "Everett", "site name": "Sumner G. Whittier School"},
            {"state": "MA", "district": "Everett", "site name": "Webster School"},
            {"state": "CA", "district": "Fairfield-Suisun", "site name": "Suisun - Anna Kyle Elementary School"},
            {"state": "CA", "district": "Fairfield-Suisun", "site name": "Suisun - Cordelia Hills Elementary School"},
            {"state": "CA", "district": "Fairfield-Suisun", "site name": "Suisun - David Weir Academy"},
            {"state": "CA", "district": "Fairfield-Suisun", "site name": "Suisun - Dover Elementary"},
            {"state": "CA", "district": "Fairfield-Suisun", "site name": "Suisun - Fairview Elementary School"},
            {"state": "CA", "district": "Fairfield-Suisun", "site name": "Suisun - Nelda Mundy Elementary School"},
            {"state": "CA", "district": "Fairfield-Suisun", "site name": "Suisun - Suisun Valley School"},
            {"state": "CA", "district": "Fairfield-Suisun", "site name": "Suisun - Sullivan Language Immersion Academy"},
            {"state": "CA", "district": "Fairfield-Suisun", "site name": "Suisun - Tolenas Academy of Music and Media"},
            {"state": "TX", "district": "Farmersville", "site name": "Farmersville Intermediate School"},
            {"state": "TX", "district": "Farmersville", "site name": "Tatum Elementary"},
            {"state": "OR", "district": "Forest Hills", "site name": "Forest Hills Lutheran Christian School"},
            {"state": "NJ", "district": "Franklin Township", "site name": "Franklin Township Elementary School"},
            {"state": "TX", "district": "Frisco", "site name": "Bert & Eloise Isbell Elementary School"},
            {"state": "TX", "district": "Frisco", "site name": "Bessie Gunstream Elementary School"},
            {"state": "TX", "district": "Frisco", "site name": "Billy Gene Phillips Elementary School"},
            {"state": "TX", "district": "Frisco", "site name": "Bright Academy"},
            {"state": "TX", "district": "Frisco", "site name": "Calvin Bledsoe Elementary School"},
            {"state": "TX", "district": "Frisco", "site name": "Charlie and Charlotte Mooneyham Elementary School"},
            {"state": "TX", "district": "Frisco", "site name": "Claude Curtsinger Elementary School"},
            {"state": "TX", "district": "Frisco", "site name": "Coy Miller Elementary school"},
            {"state": "TX", "district": "Frisco", "site name": "Doctor Erwin G and Elisabeth Pink Elementary School"},
            {"state": "TX", "district": "Frisco", "site name": "Frisco ISD Early Childhood School"},
            {"state": "TX", "district": "Frisco", "site name": "Gene and Ruby Nichols Elementary School"},
            {"state": "TX", "district": "Frisco", "site name": "George and Debra Purefoy Elementary School"},
            {"state": "TX", "district": "Frisco", "site name": "I. S. Rogers Elementary School"},
            {"state": "TX", "district": "Frisco", "site name": "Isabel Pierce Sem Elementary School"},
            {"state": "TX", "district": "Frisco", "site name": "Izetta Sparks Elementary School"},
            {"state": "TX", "district": "Frisco", "site name": "James R. Newman Elementary School"},
            {"state": "TX", "district": "Frisco", "site name": "Jessie Marie Riddle Elementary School"},
            {"state": "TX", "district": "Frisco", "site name": "Jimmy and Sammy Lane Vaughn Elementary School"},
            {"state": "TX", "district": "Frisco", "site name": "Kenneth Rex Talley Elementary School"},
            {"state": "TX", "district": "Frisco", "site name": "Liscano Elementary School"},
            {"state": "TX", "district": "Frisco", "site name": "Naoma and M. Allen Anderson Elementary School"},
            {"state": "TX", "district": "Frisco", "site name": "Noel A. Smith Elementary School"},
            {"state": "TX", "district": "Frisco", "site name": "Otis Spears Elementary School"},
            {"state": "TX", "district": "Frisco", "site name": "Pete and Gracie Hosp Elementary School"},
            {"state": "TX", "district": "Frisco", "site name": "Polly Tadlock Elementary School"},
            {"state": "TX", "district": "Frisco", "site name": "Portia Ross Taylor Elementary School"},
            {"state": "TX", "district": "Frisco", "site name": "Ruth Borchardt Elementary School"},
            {"state": "TX", "district": "Frisco", "site name": "Sonntag Elementary"},
            {"state": "TX", "district": "Frisco", "site name": "Sonny & Joanne McSpedden Elementary School"},
            {"state": "TX", "district": "Frisco", "site name": "Weldon Corbell Elementary School"},
            {"state": "TX", "district": "Frisco", "site name": "William and Abbie Allen Elementary School"},
            {"state": "TX", "district": "Frisco", "site name": "Wortham Intermediate School"},
            {"state": "NJ", "district": "Glen Ridge", "site name": "Central School"},
            {"state": "NJ", "district": "Glen Ridge", "site name": "Forest Avenue School"},
            {"state": "NJ", "district": "Glen Ridge", "site name": "Linden Avenue School"},
            {"state": "NJ", "district": "Glen Ridge", "site name": "Ridgewood Avenue Elementary School"},
            {"state": "NJ", "district": "Gloucester City", "site name": "Cold Springs School"},
            {"state": "TX", "district": "Gunter ISD", "site name": "Gunter Elementary School"},
            {"state": "NJ", "district": "Haddonfield", "site name": "Central Elementary School"},
            {"state": "NJ", "district": "Haddonfield", "site name": "Elizabeth Haddon Elementary School"},
            {"state": "NJ", "district": "Haddonfield", "site name": "J Fithian Tatem Elementary"},
            {"state": "MS", "district": "Harrison", "site name": "Bel-Aire Elementary School"},
            {"state": "MS", "district": "Harrison", "site name": "Creekbend Elementary"},
            {"state": "MS", "district": "Harrison", "site name": "Crossroads Elementary School"},
            {"state": "MS", "district": "Harrison", "site name": "Harrison Central Elementary School"},
            {"state": "MS", "district": "Harrison", "site name": "Lizana Elementary School"},
            {"state": "MS", "district": "Harrison", "site name": "Lyman Elementary School"},
            {"state": "MS", "district": "Harrison", "site name": "North Woolmarket Elementary School"},
            {"state": "MS", "district": "Harrison", "site name": "Orange Grove Elementary School"},
            {"state": "MS", "district": "Harrison", "site name": "River Oaks Elementary School"},
            {"state": "MS", "district": "Harrison", "site name": "Three Rivers Elementary School"},
            {"state": "MS", "district": "Harrison", "site name": "West Wortham Elementary & Middle School"},
            {"state": "MS", "district": "Harrison", "site name": "Woolmarket Elementary School"},
            {"state": "MA", "district": "Harvard", "site name": "Hildreth Elementary School"},
            {"state": "OR", "district": "Hillsboro", "site name": "Brookwood Elementary School"},
            {"state": "OR", "district": "Hillsboro", "site name": "Farmington View Elementary School"},
            {"state": "NJ", "district": "Hopatcong", "site name": "Durban Avenue Elementary School"},
            {"state": "NJ", "district": "Hopatcong", "site name": "Hopatcong Middle School"},
            {"state": "NJ", "district": "Hopatcong", "site name": "Tulsa Trail Elementary School"},
            {"state": "AL", "district": "Huntsville", "site name": "Academy For Academics & Arts"},
            {"state": "AL", "district": "Huntsville", "site name": "Academy For Science & Foreign Language"},
            {"state": "AL", "district": "Huntsville", "site name": "Blossomwood Elementary School"},
            {"state": "AL", "district": "Huntsville", "site name": "Challenger Elementary School"},
            {"state": "AL", "district": "Huntsville", "site name": "Farley Elementary School"},
            {"state": "AL", "district": "Huntsville", "site name": "Goldsmith Schiffman Elementary PK-5"},
            {"state": "AL", "district": "Huntsville", "site name": "Hampton Cove Elementary School"},
            {"state": "AL", "district": "Huntsville", "site name": "Jones Valley Elementary School"},
            {"state": "AL", "district": "Huntsville", "site name": "Louis J Morris School"},
            {"state": "AL", "district": "Huntsville", "site name": "Monte Sano Elementary School"},
            {"state": "AL", "district": "Huntsville", "site name": "Mountain Gap Elementary School"},
            {"state": "KY", "district": "Kenton", "site name": "Hinsdale Elementary School"},
            {"state": "KY", "district": "Kenton", "site name": "River Ridge Elementary School"},
            {"state": "KY", "district": "Kenton", "site name": "Summit View Academy"},
            {"state": "KY", "district": "Kenton", "site name": "Taylor Mill Elementary School"},
            {"state": "KY", "district": "Kenton", "site name": "White's Tower Elementary School"},
            {"state": "TX", "district": "Krum", "site name": "Blanche Dodd Elementary School"},
            {"state": "TX", "district": "Krum", "site name": "Hansel Elementary"},
            {"state": "TX", "district": "Krum", "site name": "Hattie Dyer Elementary School"},
            {"state": "TX", "district": "Lake Dallas", "site name": "Corinth Elementary School"},
            {"state": "TX", "district": "Lake Dallas", "site name": "Lake Dallas Elementary School"},
            {"state": "TX", "district": "Lake Dallas", "site name": "Shady Shores Elementary School"},
            {"state": "NJ", "district": "Lyndhurst", "site name": "Columbus Elementary School"},
            {"state": "NJ", "district": "Lyndhurst", "site name": "Franklin School"},
            {"state": "NJ", "district": "Lyndhurst", "site name": "Jefferson School"},
            {"state": "NJ", "district": "Lyndhurst", "site name": "Memorial Campus"},
            {"state": "NJ", "district": "Lyndhurst", "site name": "Roosevelt School"},
            {"state": "NJ", "district": "Lyndhurst", "site name": "Washington School"},
            {"state": "VA", "district": "Manassas", "site name": "Baldwin Elementary School"},
            {"state": "VA", "district": "Manassas", "site name": "George C Round Elementary School"},
            {"state": "VA", "district": "Manassas", "site name": "Weems Elementary School"},
            {"state": "NJ", "district": "Millburn ED", "site name": "Deerfield Elementary School"},
            {"state": "NJ", "district": "Millburn ED", "site name": "Glenwood Elementary School"},
            {"state": "NJ", "district": "Millburn ED", "site name": "Hartshorn Elementary School"},
            {"state": "NJ", "district": "Millburn ED", "site name": "South Mountain Elementary School"},
            {"state": "OK", "district": "Norman", "site name": "Eisenhower Elementary"},
            {"state": "OK", "district": "Norman", "site name": "Jackson Elementary"},
            {"state": "OK", "district": "Norman", "site name": "Lakeview Elementary"},
            {"state": "OK", "district": "Norman", "site name": "Lincoln Elementary"},
            {"state": "OK", "district": "Norman", "site name": "Monroe Elementary"},
            {"state": "OK", "district": "Norman", "site name": "Reagan Elementary"},
            {"state": "OK", "district": "Norman", "site name": "Roosevelt Elementary"},
            {"state": "OK", "district": "Norman", "site name": "Truman Primary"},
            {"state": "OK", "district": "Norman", "site name": "Washington Elementary"},
            {"state": "OK", "district": "Norman", "site name": "Whittier Middle School"},
            {"state": "OK", "district": "Norman", "site name": "Wilson Elementary School"},
            {"state": "IL", "district": "North Shore", "site name": "Braeside Elementary School"},
            {"state": "IL", "district": "North Shore", "site name": "Indian Trail Elementary School"},
            {"state": "IL", "district": "North Shore", "site name": "Oak Terrace Elementary School"},
            {"state": "IL", "district": "North Shore", "site name": "Ravinia Elementary School"},
            {"state": "IL", "district": "North Shore", "site name": "Red Oak Elementary School"},
            {"state": "IL", "district": "North Shore", "site name": "Sherwood Elementary School"},
            {"state": "IL", "district": "North Shore", "site name": "Wayne Thomas Elementary School"},
            {"state": "TX", "district": "Northwest", "site name": "Cox Elementary School"},
            {"state": "TX", "district": "Northwest", "site name": "Haslet Elementary School"},
            {"state": "TX", "district": "Northwest", "site name": "Kay Granger Elementary School"},
            {"state": "TX", "district": "Northwest", "site name": "Lish Elementary School"},
            {"state": "TX", "district": "Northwest", "site name": "Nassau Elementary School"},
            {"state": "TX", "district": "Northwest", "site name": "O A Peterson Elementary"},
            {"state": "TX", "district": "Northwest", "site name": "Prairie View Elementary School"},
            {"state": "TX", "district": "Northwest", "site name": "Roanoke Elementary School"},
            {"state": "TX", "district": "Northwest", "site name": "Samuel Beck Elementary School"},
            {"state": "TX", "district": "Northwest", "site name": "Sendera Ranch Elementary School"},
            {"state": "TX", "district": "Northwest", "site name": "Seven Hills Elementary School"},
            {"state": "TX", "district": "Northwest", "site name": "Sonny & Allegra Nance Elementary"},
            {"state": "TX", "district": "Northwest", "site name": "W R Hatfield Elementary School"},
            {"state": "MD", "district": "Prince George County", "site name": "Accokeek Academy"},
            {"state": "MD", "district": "Prince George County", "site name": "Allenwood Elementary School"},
            {"state": "MD", "district": "Prince George County", "site name": "Andrew Jackson Academy"},
            {"state": "MD", "district": "Prince George County", "site name": "Arrowhead Elementary"},
            {"state": "MD", "district": "Prince George County", "site name": "Berwyn Heights Elementary"},
            {"state": "MD", "district": "Prince George County", "site name": "Capitol Heights Elementary School"},
            {"state": "MD", "district": "Prince George County", "site name": "Clinton Grove Elementary School"},
            {"state": "MD", "district": "Prince George County", "site name": "Heather Hills Elementary School"},
            {"state": "MD", "district": "Prince George County", "site name": "Highland Park Elementary"},
            {"state": "MD", "district": "Prince George County", "site name": "Hillcrest Heights Elementary School"},
            {"state": "MD", "district": "Prince George County", "site name": "John H. Bayne Elementary School"},
            {"state": "MD", "district": "Prince George County", "site name": "John Hanson Montessori School"},
            {"state": "MD", "district": "Prince George County", "site name": "Judith P. Hoyer Montessori"},
            {"state": "MD", "district": "Prince George County", "site name": "Kettering Elementary School"},
            {"state": "MD", "district": "Prince George County", "site name": "Kingsford Elementary School"},
            {"state": "MD", "district": "Prince George County", "site name": "Lake Arbor Elementary School"},
            {"state": "MD", "district": "Prince George County", "site name": "Longfields Elementary"},
            {"state": "CA", "district": "Reedley", "site name": "Corte Madera"},
            {"state": "VA", "district": "Portsmouth", "site name": "Churchland Academy"},
            {"state": "VA", "district": "Portsmouth", "site name": "Churchland Elementary School"},
            {"state": "VA", "district": "Portsmouth", "site name": "Churchland Primary & Intermediate"},
            {"state": "VA", "district": "Portsmouth", "site name": "Hodges Manor Elementary School"},
            {"state": "VA", "district": "Portsmouth", "site name": "Lakeview Elementary School"},
            {"state": "VA", "district": "Portsmouth", "site name": "Park View Elementary School"},
            {"state": "VA", "district": "Portsmouth", "site name": "Simonsdale Elementary School"},
            {"state": "VA", "district": "Portsmouth", "site name": "Victory Elementary School"},
            {"state": "RI", "district": "PortsmouthRI", "site name": "Howard W Hathaway Elementary"},
            {"state": "RI", "district": "PortsmouthRI", "site name": "Melville Elementary School"},
            {"state": "CO", "district": "Poudre", "site name": "Baum Elementary School"},
            {"state": "CO", "district": "Poudre", "site name": "Bauder Elementary School"},
            {"state": "CO", "district": "Poudre", "site name": "Beattie Elementary School"},
            {"state": "CO", "district": "Poudre", "site name": "Bennett Elementary School"},
            {"state": "CO", "district": "Poudre", "site name": "Bethke Elementary School"},
            {"state": "CO", "district": "Poudre", "site name": "Blevins Middle School"},
            {"state": "CO", "district": "Poudre", "site name": "Clp - Irish"},
            {"state": "CO", "district": "Poudre", "site name": "Fossil Ridge High School"},
            {"state": "CO", "district": "Poudre", "site name": "French Elementary School"},
            {"state": "CO", "district": "Poudre", "site name": "Harris Elementary School"},
            {"state": "CO", "district": "Poudre", "site name": "Johnson Elementary School"},
            {"state": "CO", "district": "Poudre", "site name": "Moore Elementary School"},
            {"state": "CO", "district": "Poudre", "site name": "Olander Elementary School"},
            {"state": "CO", "district": "Poudre", "site name": "Putnam Elementary School"},
            {"state": "CO", "district": "Poudre", "site name": "Rice Elementary School"},
            {"state": "CO", "district": "Poudre", "site name": "Riffenburgh Elementary School"},
            {"state": "CO", "district": "Poudre", "site name": "Shepardson Elementary School"},
            {"state": "CO", "district": "Poudre", "site name": "Stove Prairie Elementary School"},
            {"state": "CO", "district": "Poudre", "site name": "Tavelli Elementary School"},
            {"state": "CO", "district": "Poudre", "site name": "Timnath Elementary School"},
            {"state": "CO", "district": "Poudre", "site name": "Traut Elementary School"},
            {"state": "CO", "district": "Poudre", "site name": "Werner Elementary School"},
            {"state": "CO", "district": "Poudre", "site name": "Zach Elementary School"},
            {"state": "TX", "district": "Prosper", "site name": "Betty Jackson Elementary"},
            {"state": "TX", "district": "Prosper", "site name": "Boyer Elementary School"},
            {"state": "TX", "district": "Prosper", "site name": "Finch Elementary School"},
            {"state": "TX", "district": "Prosper", "site name": "Sam Johnson Elementary"},
            {"state": "VA", "district": "Prince William", "site name": "Alexander Henderson Elementary"},
            {"state": "VA", "district": "Prince William", "site name": "Alvey Elementary School"},
            {"state": "VA", "district": "Prince William", "site name": "Antietam Elementary School"},
            {"state": "VA", "district": "Prince William", "site name": "Ashland Elementary School"},
            {"state": "VA", "district": "Prince William", "site name": "Bel Air Elementary School"},
            {"state": "VA", "district": "Prince William", "site name": "Belmont Elementary School"},
            {"state": "VA", "district": "Prince William", "site name": "Bennett Elementary School"},
            {"state": "VA", "district": "Prince William", "site name": "Bristow Run Elementary School"},
            {"state": "VA", "district": "Prince William", "site name": "Buckland Mills Elementary"},
            {"state": "VA", "district": "Prince William", "site name": "Cedar Point Elementary School"},
            {"state": "VA", "district": "Prince William", "site name": "Chris Yung Elementary School"},
            {"state": "VA", "district": "Prince William", "site name": "Dale City Elementary"},
            {"state": "VA", "district": "Prince William", "site name": "Gainesville Middle School"},
            {"state": "VA", "district": "Prince William", "site name": "Gravely Elementary School"},
            {"state": "VA", "district": "Prince William", "site name": "Irving Elementary School"},
            {"state": "VA", "district": "Prince William", "site name": "Kyle R Wilson Elementary School"},
            {"state": "VA", "district": "Prince William", "site name": "Lake Ridge Elementary School"},
            {"state": "VA", "district": "Prince William", "site name": "Leesylvania Elementary School"},
            {"state": "VA", "district": "Prince William", "site name": "Marshall Elementary School"},
            {"state": "VA", "district": "Prince William", "site name": "Martin Luther King, Jr. Elementary School"},
            {"state": "VA", "district": "Prince William", "site name": "Marumsco Hills Elementary School"},
            {"state": "VA", "district": "Prince William", "site name": "Mary G. Porter Traditional School"},
            {"state": "VA", "district": "Prince William", "site name": "Minnieville Elementary School"},
            {"state": "VA", "district": "Prince William", "site name": "Montclair Elementary School"},
            {"state": "VA", "district": "Prince William", "site name": "Mountain View Elementary School"},
            {"state": "VA", "district": "Prince William", "site name": "Mullen Elementary School"},
            {"state": "VA", "district": "Prince William", "site name": "Nokesville School"},
            {"state": "VA", "district": "Prince William", "site name": "Triangle Elementary School"},
            {"state": "VA", "district": "Prince William", "site name": "Victory Elementary School"},
            {"state": "VA", "district": "Prince William", "site name": "Westridge Elementary School"},
            {"state": "VA", "district": "Prince William", "site name": "Williams Elementary School"},
            {"state": "VA", "district": "Prince William", "site name": "Yorkshire Elementary School"},
            {"state": "MD", "district": "Queen Anne", "site name": "Centreville Elementary School"},
            {"state": "MD", "district": "Queen Anne", "site name": "Grasonville Elementary"},
            {"state": "MD", "district": "Queen Anne", "site name": "Kent Island Elementary School"},
            {"state": "MD", "district": "Queen Anne", "site name": "Matapeake Elementary School"},
            {"state": "CO", "district": "Resurrection", "site name": "Resurrection Christian School"},
            {"state": "MA", "district": "Revere", "site name": "Abraham Lincoln Elementary School"},
            {"state": "MA", "district": "Revere", "site name": "A.C. Whelan School"},
            {"state": "CA", "district": "San Ramon", "site name": "Hidden Hills Elementary"},
            {"state": "TX", "district": "Sanger", "site name": "Butterfield Elementary"},
            {"state": "TX", "district": "Sanger", "site name": "Chisholm Trail Elementary"},
            {"state": "TX", "district": "Sanger", "site name": "Clear Creek Intermediate"},
            {"state": "MA", "district": "Spencer-East Brookfield", "site name": "East Brookfield Elementary"},
            {"state": "MA", "district": "Spencer-East Brookfield", "site name": "Wire Village School"},
            {"state": "MA", "district": "Somerset", "site name": "Chace Street Elementary School"},
            {"state": "MA", "district": "Somerset", "site name": "North Elementary School"},
            {"state": "MA", "district": "Somerset", "site name": "South Elementary School"},
            {"state": "NJ", "district": "Sparta", "site name": "Alpine Elementary School"},
            {"state": "NJ", "district": "Sparta", "site name": "Helen Morgan Elementary School"},
            {"state": "NJ", "district": "Sparta", "site name": "Mohawk Avenue School"},
            {"state": "NJ", "district": "Sparta", "site name": "Sparta Middle School"},
            {"state": "TX", "district": "Sunnyvale", "site name": "Sunnyvale Elementary School"},
            {"state": "NJ", "district": "Warren", "site name": "Central School"},
            {"state": "NJ", "district": "Warren", "site name": "Mount Horeb Elementary School"},
            {"state": "NJ", "district": "Warren", "site name": "Woodland School"},
            {"state": "RI", "district": "Warwick", "site name": "Cedar Hill Elementary"},
            {"state": "RI", "district": "Warwick", "site name": "Holliman Elementary"},
            {"state": "RI", "district": "Warwick", "site name": "Lippitt Elementary"},
            {"state": "RI", "district": "Warwick", "site name": "Robertson Elementary"},
            {"state": "RI", "district": "Warwick", "site name": "Scott Elementary"},
            {"state": "RI", "district": "Warwick", "site name": "Sherman Elementary School"},
            {"state": "RI", "district": "Warwick", "site name": "Warwick Neck Elementary"},
            {"state": "NJ", "district": "Washington Township", "site name": "Brass Castle Elementary"},
            {"state": "NJ", "district": "Washington Township", "site name": "Port Colden Elementary"},
            {"state": "CO", "district": "Weld", "site name": "Grandview Elementary"},
            {"state": "CO", "district": "Weld", "site name": "Hollister Lake Elementary"},
            {"state": "CO", "district": "Weld", "site name": "Milliken Elementary School"},
            {"state": "CO", "district": "Weld", "site name": "Mountain View Elementary"},
            {"state": "CO", "district": "Weld", "site name": "North Valley Middle School"},
            {"state": "CO", "district": "Weld", "site name": "Pioneer Elementary"},
            {"state": "CO", "district": "Weld", "site name": "Weld Central Middle School"},
            {"state": "CO", "district": "Weld", "site name": "Weld Central High School"},
            {"state": "CO", "district": "Weld", "site name": "West Ridge Elementary School"}
        ]; 
        
        // --- Helper Functions (No Change) ---
        
        function getUniqueAndSorted(list, key) {
            const uniqueItems = [...new Set(list.map(item => item[key]))];
            return uniqueItems.sort();
        }

        function toggleOtherInput(dropdownId) {
            const dropdown = document.getElementById(dropdownId);
            const otherInput = document.getElementById(`other${dropdownId.charAt(0).toUpperCase() + dropdownId.slice(1)}Input`);
            
            if (dropdown.value === 'Other') {
                otherInput.style.display = 'block';
                otherInput.focus();
            } else {
                otherInput.style.display = 'none';
                otherInput.value = ''; 
            }
            
            setTimeout(() => { 
                if (typeof JFCustomWidget !== 'undefined') { 
                    JFCustomWidget.requestFrameResize();
                } 
            }, 0);
        }

        // --- Core Dropdown Update Logic (No Change) ---
        
        function updateDistricts() {
            const stateSel = document.getElementById('state');
            const districtSel = document.getElementById('district');
            const siteSel = document.getElementById('site');
            
            districtSel.innerHTML = '<option value="">Choose District</option>';
            siteSel.innerHTML = '<option value="">Choose District First</option>';
            districtSel.disabled = true;
            siteSel.disabled = true;
            document.getElementById('otherDistrictInput').style.display = 'none';
            document.getElementById('otherSiteInput').style.display = 'none';
            
            const selectedState = stateSel.value;
            
            if (selectedState && selectedState !== 'Other') {
                const filteredDistricts = data.filter(item => item.state === selectedState);
                let districts = getUniqueAndSorted(filteredDistricts, 'district');
                
                districts.push('Other');
                
                const districtOptions = districts.map(d => `<option value="${d}">${d}</option>`).join('');
                districtSel.innerHTML += districtOptions;
                districtSel.disabled = false;
            } else if (selectedState === 'Other') {
                 districtSel.disabled = true;
                 siteSel.disabled = true;
            }
            // sendWidgetData() is called by the onchange event in the HTML
        }
        
        function updateSites() {
            const stateSel = document.getElementById('state');
            const districtSel = document.getElementById('district');
            const siteSel = document.getElementById('site');
            
            siteSel.innerHTML = '<option value="">Choose Site</option>';
            siteSel.disabled = true;
            document.getElementById('otherSiteInput').style.display = 'none';
            
            const selectedState = stateSel.value;
            const selectedDistrict = districtSel.value;
            
            if (selectedState && selectedDistrict && selectedDistrict !== 'Other') {
                const filteredSites = data.filter(item => 
                    item.state === selectedState && item.district === selectedDistrict
                );
                
                let sites = getUniqueAndSorted(filteredSites, 'site name');
                
                sites.push('Other');
                
                const siteOptions = sites.map(s => `<option value="${s}">${s}</option>`).join('');
                siteSel.innerHTML += siteOptions;
                siteSel.disabled = false;
            } else if (selectedDistrict === 'Other') {
                 siteSel.disabled = true;
            }
            // sendWidgetData() is called by the onchange event in the HTML
        }

        // --- Data Aggregation and Transmission Logic (NEW) ---
        
        // 1. Helper function to get the current structured data
        function getWidgetData() {
            let stateValue = document.getElementById("state").value;
            let districtValue = document.getElementById("district").value;
            let siteValue = document.getElementById("site").value;

            // Use the value from the text box if "Other" is selected
            if (stateValue === 'Other') {
                stateValue = document.getElementById("otherStateInput").value;
            }

            if (districtValue === 'Other') {
                districtValue = document.getElementById("otherDistrictInput").value;
            }
            
            if (siteValue === 'Other') {
                siteValue = document.getElementById("otherSiteInput").value;
            }
            
            // Create the structured data object
            const structuredData = {
                state: stateValue,
                district: districtValue,
                site: siteValue
            };

            // Convert the JavaScript object into a JSON string
            return JSON.stringify(structuredData);
        }

        // 2. Function to send data on every change (Clears the "Required" error)
        function sendWidgetData() {
            if (typeof JFCustomWidget === 'undefined') {
                return;
            }
            const jsonString = getWidgetData();
            // sendData tells JotForm the field has content, clearing the error state
            JFCustomWidget.sendData({ valid: true, value: jsonString });
        }


        // 3. Submission Logic to handle final validation (Called only on final Submit)
        function setupSubmitListener() {
            if (typeof JFCustomWidget === 'undefined') {
                return;
            }

            JFCustomWidget.subscribe('submit', function(e) {
                const stateDropdownValue = document.getElementById("state").value;
                const otherStateInputValue = document.getElementById("otherStateInput").value.trim();
                const finalJsonString = getWidgetData(); 

                // Check for validation error (State dropdown is empty OR "Other" is selected but the text box is empty)
                if (stateDropdownValue === '' || (stateDropdownValue === 'Other' && otherStateInputValue === '')) {
                    // Send an invalid result back to JotForm to stop submission
                    JFCustomWidget.sendSubmit({ 
                        valid: false, 
                        value: '',
                        message: "Please select a State or fill in the 'Other' field." 
                    });
                    return; // Stop processing
                }
                
                // Send the final, validated data to JotForm to allow submission
                let result = {
                    valid: true,
                    value: finalJsonString // Pass the JSON string to JotForm
                };
                JFCustomWidget.sendSubmit(result);
            });
        }


        // --- Initialization (UPDATED) ---

        function initialize() {
            const stateSel = document.getElementById('state');
            
            // 1. Get and populate States
            const states = getUniqueAndSorted(data, 'state');
            states.push("Other");
            const stateOptions = states.map(s => `<option value="${s}">${s}</option>`).join('');
            stateSel.innerHTML += stateOptions;
            
            // 2. Disable lower dropdowns initially
            document.getElementById('district').disabled = true;
            document.getElementById('site').disabled = true;

            // 3. Set up the submission listener
            setupSubmitListener();

            // 4. Send initial data. IMPORTANT: This clears the "required" error immediately on load.
            sendWidgetData(); 

            // 5. Request initial resize (important for some browsers)
            if (typeof JFCustomWidget !== 'undefined') { 
                JFCustomWidget.requestFrameResize(); 
            }
        }
        
        // Run initialization function when the page loads
        initialize();

    </script>
</body>
</html>
